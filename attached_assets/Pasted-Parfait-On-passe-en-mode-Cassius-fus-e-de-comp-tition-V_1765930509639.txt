Parfait. On passe en mode Cassius / fus√©e de comp√©tition üöÄ
Voici le prompt Replit V3, r√©√©crit proprement, scalable, DB-first, en int√©grant :
	‚Ä¢	‚úÖ Enums m√©tier configurables en BDD (JSONB) quand c‚Äôest pertinent
	‚Ä¢	‚úÖ Fallback code pour la robustesse
	‚Ä¢	‚úÖ Z√©ro hardcode c√¥t√© front & schema
	‚Ä¢	‚úÖ ESLint + Prettier comme garde-fous officiels
	‚Ä¢	‚úÖ Docs restructur√©es niveau plateforme s√©rieuse

üëâ Tu peux copier-coller ce prompt tel quel dans Replit.

‚∏ª

üéØ PROMPT REPLIT V3 ‚Äî PLANBASE ‚ÄúCONFIG REGISTRY + DOCS CLEAN‚Äù

Tu es l‚Äôagent Replit charg√© de faire √©voluer PlanBase vers une architecture scalable et configurable, sans casser l‚Äôexistant.

Objectifs globaux
	1.	Mettre en place un Config Registry DB-first (JSONB) pour les param√®tres m√©tier configurables.
	2.	Garder une ossature code stable (fallback defaults) pour la s√©curit√© et le typage.
	3.	Supprimer toute duplication d‚Äôenums m√©tier dans le code (front & schema).
	4.	Installer ESLint + Prettier pour verrouiller la qualit√©.
	5.	R√©organiser toute la documentation dans une arborescence docs/ claire et professionnelle.

‚∏ª

1) Architecture cible (vision)

1.1 Principe cl√©

üëâ Tout ce qui peut changer sans redeploy doit √™tre en DB.
üëâ Tout ce qui structure le syst√®me reste en code.

En DB (configurable)
	‚Ä¢	project stages / pipeline stages
	‚Ä¢	kanban columns / workflows
	‚Ä¢	cat√©gories & tags de temps
	‚Ä¢	seuils de reporting & recommandations
	‚Ä¢	labels / couleurs / ordre

En code (stable)
	‚Ä¢	r√¥les & permissions
	‚Ä¢	modes (KANBAN / SCRUM)
	‚Ä¢	types techniques critiques
	‚Ä¢	fallback par d√©faut (shared/config)

‚∏ª

2) Config Registry ‚Äî Backend (DB-first)

2.1 Cr√©er la table settings

Ajouter une table settings (Supabase / Drizzle) :

settings (
  id uuid primary key,
  scope text not null,           -- SYSTEM | ACCOUNT | USER | PROJECT
  scope_id uuid,                 -- nullable pour SYSTEM
  key text not null,             -- ex: project.stages, reports.thresholds
  value jsonb not null,
  version int default 1,
  updated_at timestamptz,
  updated_by uuid
)

Index :
	‚Ä¢	(scope, scope_id, key)

2.2 Service backend de r√©solution de config

Cr√©er un service configService :
	‚Ä¢	charge les defaults depuis shared/config
	‚Ä¢	surcharge avec :
	‚Ä¢	ACCOUNT
	‚Ä¢	puis USER
	‚Ä¢	retourne une config effective et typ√©e

Cr√©er l‚Äôendpoint :

GET /api/config

Optionnel :

PUT /api/config/:key

(prot√©g√©, admin only)

‚∏ª

3) shared/config ‚Äî fallback code & typing

Conserver et compl√©ter :

shared/config/
  projectStages.ts
  taskStatuses.ts
  taskPriorities.ts
  billingStatuses.ts
  timeCategories.ts
  thresholds.ts
  index.ts

Chaque config :
	‚Ä¢	contient les defaults
	‚Ä¢	exporte les key stables
	‚Ä¢	sert de fallback si la DB est vide

‚ö†Ô∏è Ces fichiers ne contiennent aucune logique UI (juste data + helpers).

‚∏ª

4) Schema : validation align√©e DB + fallback

4.1 shared/schema.ts
	‚Ä¢	Supprimer TOUT enum m√©tier en dur
	‚Ä¢	Importer les key depuis shared/config
	‚Ä¢	Valider :
	‚Ä¢	soit contre les keys DB charg√©es (si runtime)
	‚Ä¢	soit contre les defaults (fallback)

Le schema valide les cl√©s, jamais les labels/couleurs.

‚∏ª

5) Frontend : consommation via Config API

5.1 Hook useConfig()

Cr√©er :

client/src/hooks/useConfig.ts

	‚Ä¢	fetch /api/config
	‚Ä¢	expose :
	‚Ä¢	projectStages
	‚Ä¢	taskPriorities
	‚Ä¢	thresholds
	‚Ä¢	etc.

5.2 Interdictions
	‚Ä¢	‚ùå plus de const stages = [...]
	‚Ä¢	‚ùå plus de <SelectItem value="..."> m√©tier en dur
	‚Ä¢	‚ùå plus de switch(status) bas√© sur string

Tout passe par useConfig().

‚∏ª

6) ESLint + Prettier (non n√©gociable)

6.1 Installer
	‚Ä¢	eslint
	‚Ä¢	eslint-config-standard / airbnb (choisir 1)
	‚Ä¢	eslint-plugin-react
	‚Ä¢	eslint-plugin-import
	‚Ä¢	eslint-plugin-unused-imports
	‚Ä¢	prettier
	‚Ä¢	eslint-config-prettier

6.2 R√®gles cl√©s
	‚Ä¢	pas de tableaux d‚Äôoptions m√©tier inline
	‚Ä¢	pas de z.enum([...]) en dur
	‚Ä¢	pas de switch sur string m√©tier

6.3 Script anti-hardcode

Ajouter :

npm run check:hardcode

Script qui grep :
	‚Ä¢	const (stages|statuses|priorities) = [
	‚Ä¢	<SelectItem value=
	‚Ä¢	z.enum([

Supporter // hardcode-ok comme exception.

‚∏ª

7) Rework Docs ‚Äî Arborescence propre

Cr√©er :

docs/
  README.md
  00-getting-started/
  10-architecture/
  20-database/
  30-security/
  40-operations/
  50-product/
  60-changelog/
  70-technical-debt/

7.1 Migration

D√©placer tous les .md existants depuis la racine vers docs/
Mettre √† jour tous les liens relatifs.

7.2 Standard doc

Chaque doc doit contenir :
	‚Ä¢	But
	‚Ä¢	Audience
	‚Ä¢	Pr√©requis
	‚Ä¢	Derni√®re mise √† jour
	‚Ä¢	Liens associ√©s

7.3 README racine
	‚Ä¢	garder intro courte
	‚Ä¢	pointer vers docs/README.md

‚∏ª

8) Ordre d‚Äôex√©cution STRICT
	1.	Table settings + service backend
	2.	shared/config (fallback complet)
	3.	schema.ts align√©
	4.	front ‚Üí useConfig()
	5.	ESLint + scripts garde-fous
	6.	Rework docs
	7.	Build & lint final

‚∏ª

9) Crit√®res de r√©ussite
	‚Ä¢	Aucun enum m√©tier configurable n‚Äôest hardcod√©
	‚Ä¢	Une config peut changer sans redeploy
	‚Ä¢	Le front ne conna√Æt que des configs charg√©es
	‚Ä¢	Les docs sont navigables, index√©es, propres
	‚Ä¢	ESLint emp√™che toute r√©gression

‚∏ª

Vision finale

PlanBase doit pouvoir :
	‚Ä¢	ajouter une √©tape projet
	‚Ä¢	changer un seuil
	‚Ä¢	adapter un workflow

üëâ sans toucher au code
üëâ sans casser le typage
üëâ sans redeployer

C‚Äôest ce niveau d‚Äôexigence que j‚Äôattends.

‚∏ª

Si tu veux, prochaine √©tape :
‚û°Ô∏è Prompt V4 : UI admin ‚ÄúSettings avanc√©s‚Äù + audit trail + historique des configs.